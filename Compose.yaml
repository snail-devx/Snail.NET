name: snail
services:
  # -------------------------------------------------    ğŸ‘‰ğŸ‘‰  åŸºç¡€ æœåŠ¡  ------------------------------------------------- 
  redis:
    image: redis:6.2.14
    container_name: redis
    restart: unless-stopped
    # ç½‘ç»œç«¯å£é…ç½®ï¼šå¼€å‘æœºå™¨6379è¢«å ç”¨ï¼Œè¿™é‡Œè®©ä½æ”¹ä¸º6378
    networks: 
      - snail-net
    ports: 
      - "6378:6379"
    # ç¯å¢ƒå˜é‡é…ç½®
    environment:
      - TZ=Asia/Shanghai
      - LANG=C.UTF-8
    # å¯åŠ¨å‘½ä»¤é…ç½®ï¼šå¼€å¯ AOF æŒä¹…åŒ–ï¼›è‡ªå®šä¹‰å¯†ç 
    command: 
      - redis-server
      - --appendonly
      - "yes"
      - --requirepass
      - jaAED7zUngPJHyTe
  rabbitmq:
    image: rabbitmq:3.6.2-management
    container_name: rabbitmq
    restart: unless-stopped
    # ç½‘ç»œç«¯å£é…ç½®
    networks: 
      - snail-net
    ports:
      - "5672:5672"
      - "15672:15672"
    # ç¯å¢ƒå˜é‡é…ç½®ï¼šæŒ‡å®šç”¨æˆ·å’Œå¯†ç 
    environment:
      - TZ=Asia/Shanghai
      - LANG=C.UTF-8
      - RABBITMQ_DEFAULT_USER=rabbit
      - RABBITMQ_DEFAULT_PASS=jaAED7zUngPJHyTe
  # -------------------------------------------------    ğŸ‘‰ğŸ‘‰  æ•°æ®åº“ æœåŠ¡  ------------------------------------------------- 
  mysql:
    image: mysql:5.7.36
    container_name: mysql
    restart: unless-stopped
    # ç½‘ç»œç«¯å£é…ç½®
    networks: 
      - snail-net
    ports: 
      - "3306:3306"
    # ç¯å¢ƒå˜é‡é…ç½®ï¼šæŒ‡å®šrootç”¨æˆ·å¯†ç 
    environment:
      - TZ=Asia/Shanghai
      - LANG=C.UTF-8
      - MYSQL_ROOT_PASSWORD=jaAED7zUngPJHyTe
    # å¯åŠ¨å‘½ä»¤é…ç½®ï¼šå¼ºåˆ¶æ‰€æœ‰ç¯èŠ‚ä½¿ç”¨ utf8mb4 é¿å…æ’å…¥ä¸­æ–‡å­—ç¬¦æ˜¾ç¤ºä¸º ?
    command: 
      - --character-set-server=utf8mb4
      - --collation-server=utf8mb4_unicode_ci
      - --default-authentication-plugin=mysql_native_password
  postgres:
    image: postgres:14.12
    container_name: postgres
    restart: unless-stopped
    # ç½‘ç»œç«¯å£é…ç½®
    networks: 
      - snail-net
    ports: 
      - "5432:5432"
    # ç¯å¢ƒå˜é‡é…ç½®ï¼šæŒ‡å®šrootç”¨æˆ·å’Œå¯†ç 
    environment:
      - TZ=Asia/Shanghai
      - LANG=C.UTF-8
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=jaAED7zUngPJHyTe
  mongo:
    image: mongo:4.0.27
    container_name: mongo
    restart: unless-stopped
    # ç½‘ç»œç«¯å£é…ç½®
    ports: 
      - "27017:27017"
    networks: 
      - snail-net
    # ç¯å¢ƒå˜é‡é…ç½®ï¼šæŒ‡å®šrootç”¨æˆ·å’Œå¯†ç 
    environment:
      - TZ=Asia/Shanghai
      - LANG=C.UTF-8
      - MONGO_INITDB_ROOT_USERNAME=root
      - MONGO_INITDB_ROOT_PASSWORD=jaAED7zUngPJHyTe
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.4.3
    container_name: elasticsearch
    restart: unless-stopped
    # ç½‘ç»œç«¯å£é…ç½®
    ports:
      - "9200:9200"
      - "9300:9300"
    networks: 
      - snail-net
    # ç¯å¢ƒå˜é‡é…ç½®ï¼šæŒ‡å®šelasticç”¨æˆ·å¯†ç ç­‰
    environment:
      - discovery.type=single-node
      - ELASTIC_PASSWORD=jaAED7zUngPJHyTe
      # 2Gå †å†…å­˜ï¼ˆæ ¹æ®å®¿ä¸»æœºå†…å­˜è°ƒæ•´ï¼‰
      - ES_JAVA_OPTS=-Xmx2g
      # ç¦ç”¨ GeoIP æ•°æ®åº“è‡ªåŠ¨ä¸‹è½½ï¼›éœ€è¦æ—¶æ‰ä¸‹è½½
      - ingest.geoip.downloader.enabled=false
      # åœ¨ å•èŠ‚ç‚¹ + è‡ªåŠ¨å®‰å…¨æ¨¡å¼ä¸‹ï¼Œä¸è¦æ˜¾å¼è®¾ç½®ä»¥ä¸‹å‚æ•°ï¼š è‹¥æ˜¾å¼è®¾ç½®äº†ï¼Œåˆ™éœ€è¦æä¾›è¯ä¹¦è·¯å¾„
      # - xpack.security.enabled=true
      # - xpack.security.http.ssl.enabled=true
      # - xpack.security.transport.ssl.enabled=true
    # èµ„æºé…ç½®ï¼šé™åˆ¶å†…å­˜ç­‰
    mem_limit: 4g
    ulimits:
      memlock:
        soft: -1
        hard: -1
  # -------------------------------------------------    ğŸ‘‰ğŸ‘‰  å¯é€‰æœåŠ¡ï¼Œé»˜è®¤ä¸æ”¾å¼€  ------------------------------------------------- 
  ##    ä½¿ç”¨å‰ï¼Œå…ˆè¿›è¡Œ kibana_system è´¦å·å¯†ç è®¾ç½®ï¼Œç„¶åå†è§£æ³¨é‡Šä¸‹é¢æœåŠ¡ 
  ##    å¯åŠ¨ElasticSearchåï¼Œæ‰§è¡Œå‘½ä»¤ï¼š docker exec -it elasticsearch /usr/share/elasticsearch/bin/elasticsearch-reset-password -u kibana_system -i
  ##    å‚è€ƒèµ„æ–™ï¼šhttps://www.yuque.com/snail-devx/dev/qi6zds#e3Ghs
  #kibana: 
  #  image: docker.elastic.co/kibana/kibana:8.4.3
  #  container_name: kibana
  #  restart: unless-stopped
  #  depends_on:
  #    - elasticsearch
  #  # ç½‘ç»œç«¯å£é…ç½®
  #  networks: 
  #    - snail-net
  #  ports: 
  #    - "5601:5601"
  #  # ç¯å¢ƒå˜é‡é…ç½®ï¼šé…ç½®ElasticSearchæ•°æ®åº“è¿æ¥ç›¸å…³é…ç½®
  #  environment:
  #    - ELASTICSEARCH_HOSTS=https://elasticsearch:9200
  #    - ELASTICSEARCH_SSL_VERIFICATIONMODE=none
  #    - SERVER_SSL_ENABLED=false
  #    - ELASTICSEARCH_USERNAME=kibana_system
  #    - ELASTICSEARCH_PASSWORD=jaAED7zUngPJHyTe
  #    - i18n.locale=zh-CN
# ç»Ÿä¸€ç½‘ç»œï¼ŒæœåŠ¡å†…éƒ¨å¯é€šè¿‡æœåŠ¡åç›´æ¥è®¿é—®
networks:
  snail-net:
    driver: bridge